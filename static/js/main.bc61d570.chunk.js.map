{"version":3,"sources":["utils/nop.js","contexts/router.js","providers/router/index.js","providers/router/use-route.js","contexts/users.js","contexts/products.js","providers/index.js","components/route/index.js","components/link/index.js","components/topbar/index.js","components/list/index.js","components/list-item/index.js","components/user-detail/index.js","components/list-users/index.js","shell/users.js","components/list-products/index.js","index.js","routes.js"],"names":["nop","context","createContext","url","go","params","setParams","Router","_ref","children","_useRoute","_useState","useState","window","location","pathname","_useState2","Object","slicedToArray","setUrl","useEffect","history","e","useRoute","_useRoute2","react_default","a","createElement","router","Provider","value","users","requestUsers","hello","products","nameToId","item","index","objectSpread","id","slug","name","toLowerCase","replace","fetchUsers","fetch","then","resp","json","response","results","data","map","fetchUser","query","arguments","length","undefined","Promise","resolve","fetchProducts","fetchProduct","externalResources","loadImage","src","image","Image","onload","setTimeout","route","pathMatch","Route","path","useContext","RouterContext","match","split","filter","r","v","i","LinkGenerator","href","props","objectWithoutProperties","assign","Link","_ref2","component","LinkComponent","onClick","preventDefault","stopPropagation","throwPromise","Topbar","clearCache","usersContext","className","List","_ref$items","items","ListItem","UserDetail","getResource","react","fallback","srcImage","alt","gender","birth_year","ListUsers","user","key","String","UserShell","ListProduct","product","require","rootElement","document","getElementById","ReactDOM","render","StrictMode","index_es","productsContext"],"mappings":"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","file":"static/js/main.bc61d570.chunk.js","sourcesContent":["export default function nop() {}\n","import { createContext } from \"react\";\nimport nop from \"./../utils/nop\";\n\nconst context = createContext({\n  url: null,\n  go: nop,\n  params: {},\n  setParams: nop\n});\n\nexport default context;\n","import React from \"react\";\n\nimport useRoute from \"./use-route\";\n\nimport RouterContext from \"./../../contexts/router\";\n\nfunction Router({ children }) {\n  const [url, go] = useRoute();\n\n  return (\n    <RouterContext.Provider value={{ url, go }}>\n      {children}\n    </RouterContext.Provider>\n  );\n}\n\nexport { Router as default };\n","// eslint-disable-next-line\nimport React, { useState, useEffect } from \"react\";\nimport history from \"browser-history\";\n\nexport default function useRoute() {\n  const [url, setUrl] = useState(window.location.pathname);\n\n  useEffect(() => {\n    history((e, url) => setUrl(url));\n  });\n\n  function go(url) {\n    setUrl(url);\n    history(url);\n  }\n\n  return [url, go];\n}\n","import { createContext } from \"react\";\nimport nop from \"./../utils/nop\";\n\nconst context = createContext({\n  users: [],\n  requestUsers: nop,\n  hello: null\n});\n\nexport default context;\n","import { createContext } from \"react\";\n\nconst context = createContext({\n  products: []\n});\n\nexport default context;\n","import React from \"react\";\nimport Provider from 'context-cache-provider';\n\nimport RouterProvider from \"./router\";\n\nimport usersContext from \"./../contexts/users\";\nimport productsContext from \"./../contexts/products\";\n\n\nfunction nameToId(item, index) {\n  return {...item, id: index+1, slug: item.name.toLowerCase().replace(' ', '_')}\n}\nfunction fetchUsers() {\n  return fetch(\"https://swapi.co/api/people/\")\n  .then(resp => resp.json())\n  .then(response => response.results)\n  .then(data => data.map(nameToId));\n}\n\nfunction fetchUser(query = {}) {\n  if (!query.id) return new Promise(resolve => resolve([]));\n\n  return fetch(\"https://swapi.co/api/people/\" + query.id)\n    .then(resp => resp.json())\n    .then(nameToId);\n}\n\nfunction fetchProducts() {\n  return fetch(\"https://swapi.co/api/starships/\")\n  .then(resp => resp.json())\n  .then(response => response.results)\n  .then(data => data.map(nameToId));\n}\n\nfunction fetchProduct(query = {}) {\n  if (!query.id) return new Promise(resolve => resolve([]));\n\n  return fetch(\"https://swapi.co/api/starships/\" + query.id)\n    .then(resp => resp.json())\n    .then(nameToId);\n}\n\n/**\n * external resources\n *\n * You could have your external resources using separate provider and context\n *\n * @type {{loadImage: (function(*=): Promise<any>)}}\n */\nconst externalResources = {\n  loadImage: function(src) {\n    const image = new Image();\n    return new Promise(resolve => {\n      image.onload = () => setTimeout(() => resolve(src), 3000);\n      image.src = src;\n    });\n  }\n};\n\nexport default function Providers({ children }) {\n  return (\n    <Provider\n      context={productsContext}\n      fetchProducts={fetchProducts}\n      fetchProduct={fetchProduct}\n    >\n      <Provider\n        context={usersContext}\n        fetchUsers={fetchUsers}\n        fetchUser={fetchUser}\n        {...externalResources}\n      >\n        <RouterProvider>{children}</RouterProvider>\n      </Provider>\n    </Provider>\n  );\n}\n","// eslint-disable-next-line\nimport React, { useContext } from \"react\";\nimport pathMatch from \"path-match\";\n\nimport RouterContext from \"./../../contexts/router\";\n\nconst route = pathMatch();\n\nexport default function Route({ path, children }) {\n  const { url } = useContext(RouterContext);\n  const match = route(path);\n  const params = match(url);\n  if (params !== false) {\n    url.split(\"/\")\n      .filter(r => r)\n      .map((v,i) => (params[i] = v))\n    return children(params);\n  }\n  return null;\n}\n","import React, { useContext } from \"react\";\nimport RouterContext from \"./../../contexts/router\";\n\nfunction LinkGenerator({ href, children, ...props }) {\n  return <a {...props} href={href || '!#'} >{children}</a>;\n}\n\nexport default function Link({ component, ...props }) {\n  const { go } = useContext(RouterContext);\n  const LinkComponent = component || LinkGenerator;\n\n  return <LinkComponent {...props} onClick={(e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    props.onClick && props.onClick(e);\n    props.href && go(props.href);\n  }} />\n}\n\n","import React, {useContext} from \"react\";\nimport Link from \"./../link\";\n\nimport usersContext from \"./../../contexts/users\";\n\nfunction throwPromise() {\n  const p = new Promise(resolve => {\n    setTimeout(resolve, 5000);\n  });\n\n  throw p;\n}\n\nexport default function Topbar() {\n  const {clearCache} = useContext(usersContext);\n\n  return (\n    <div className=\"topbar\">\n      <Link href=\"/\">Home</Link>\n      <Link href=\"/users\">People</Link>\n      <Link href=\"/products\">Products</Link>\n      <Link onClick={()=>clearCache()}>Clear cache</Link>\n      <Link onClick={throwPromise}>Throw</Link>\n    </div>\n  );\n}\n","import React from \"react\";\n\nexport default function List({ items = [], children, ...props }) {\n  if (!items) return null;\n  return <ul {...props}>{items.map(children)}</ul>;\n}\n","import React from \"react\";\n\nexport default function ListItem({ children }) {\n  return <li>{children}</li>;\n}\n","import React, { useContext, Suspense } from \"react\";\n\nimport context from \"./../../contexts/users\";\n\nexport default function UserDetail({ id }) {\n  const { getResource } = useContext(context);\n\n  const data = getResource(\"fetchUser\")({ id });\n\n  if (!data)\n    return null;\n\n  function RenderImage({ src }) {\n    const srcImage = getResource(\"loadImage\")(\n      \"https://raw.githubusercontent.com/johnlindquist/swapi-json-server/master/public/\" + data.image\n    );\n    return <img src={srcImage} alt={data.name} />;\n  }\n\n  return (\n    <div className=\"user-detail\">\n      <div className=\"image\">\n        <Suspense fallback={<div>loading image...</div>}>\n          {data.image && <RenderImage src={data.image} />}\n        </Suspense>\n      </div>\n      <div className=\"name\">Name: {data.name}</div>\n      <div className=\"name\">Gender: {data.gender}</div>\n      <div className=\"name\">Birth Year: {data.birth_year}</div>\n    </div>\n  );\n}\n","import React, { useContext, Suspense } from \"react\";\n\nimport usersContext from \"./../../contexts/users\";\n// import routerContext from \"./../../contexts/router\";\n\nimport Link from \"./../link\";\nimport List from \"./../list\";\nimport ListItem from \"./../list-item\";\nimport UserDetail from \"./../user-detail\";\n\nexport default function ListUsers({ id }) {\n  /**\n   * Now I can use my context to getResource and use Suspense\n   */\n  const { getResource } = useContext(usersContext);\n  // const { go } = useContext(routerContext);\n\n  const data = getResource(\"fetchUsers\")({});\n\n  if (!data)\n    return null;\n\n  return (\n    <List items={data}>\n      {user => (\n        <ListItem key={user.id}>\n          {String(user.id) !== String(id) && (\n            <h2>\n              <Link href={\"/users/\" + user.id}>{user.name}</Link>\n            </h2>\n          )}\n          {String(user.id) === String(id) && (\n            <Suspense fallback={<div>Loading user detail...</div>}>\n              <UserDetail id={id} />\n            </Suspense>\n          )}\n        </ListItem>\n      )}\n    </List>\n  );\n}\n","import React, { Suspense } from \"react\";\n\nimport ListUsers from \"./../components/list-users\";\n\nexport default function UserShell({ id }) {\n  return (\n    <Suspense fallback={<div>Loading user list...</div>}>\n      <ListUsers id={id} />\n    </Suspense>\n  );\n}\n","import React, { useContext } from \"react\";\n\nimport context from \"./../../contexts/products\";\n// import routerContext from \"./../../contexts/router\";\n\nimport List from \"./../list\";\nimport ListItem from \"./../list-item\";\n\nexport default function ListProduct() {\n  const { getResource } = useContext(context);\n  // const { url, params } = useContext(routerContext);\n\n  const data = getResource(\"fetchProducts\")({ id: 9, name: \"Leonard\" });\n\n  return (\n    <List items={data}>\n      {product => <ListItem key={product.id}>{product.name}</ListItem>}\n    </List>\n  );\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport Providers from \"./providers\";\n\nimport RootAppRoutes from \"./routes\";\n\nrequire(\"./styles.css\");\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(\n  <React.StrictMode>\n    <Providers>\n      <RootAppRoutes />\n    </Providers>\n  </React.StrictMode>,\n  rootElement\n);\n","import React, { Suspense } from \"react\";\n\nimport Route from \"./components/route\";\nimport Topbar from \"./components/topbar\";\nimport UserShell from \"./shell/users\";\nimport ListProdutcs from \"./components/list-products\";\n\nexport default function Routes() {\n  return (\n    <Suspense fallback={<div>global loading...</div>}>\n      <Route path=\"(.*)\">{params => <Topbar />}</Route>\n      <Route path=\"/\">{params => <div>initial</div>}</Route>\n      <Route path=\"/users/:id?\">{params => <UserShell {...params} />}</Route>\n      <Route path=\"/products(/.*)?\">{params => <ListProdutcs />}</Route>\n    </Suspense>\n  );\n}\n"],"sourceRoot":""}