(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(e,t,n){e.exports=n(42)},40:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(9),s=n.n(i),c=n(12),u=n(3),o=n.n(u),l=n(10),h=n.n(l),f=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},m=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},v=Symbol("N"),p=Symbol("O"),E=function(){function e(t,n){f(this,e),this.size=0,this.limit=t,this.oldest=this.newest=void 0,this.map=new Map,n&&(this.assign(n),t<1&&(this.limit=this.size))}return m(e,[{key:"_bump",value:function(e){e!==this.newest&&(e[v]&&(e===this.oldest&&(this.oldest=e[v]),e[v][p]=e[p]),e[p]&&(e[p][v]=e[v]),e[v]=void 0,e[p]=this.newest,this.newest&&(this.newest[v]=e),this.newest=e)}},{key:"get",value:function(e){var t=this.map.get(e);if(t)return this._bump(t),t.value}},{key:"set",value:function(e,t){var n=this.map.get(e);return n?(n.value=t,this._bump(n),this):(this.map.set(e,n={key:e,value:t}),this.newest?(this.newest[v]=n,n[p]=this.newest):this.oldest=n,this.newest=n,++this.size,this.size>this.limit&&this.shift(),this)}},{key:"shift",value:function(){var e=this.oldest;if(e)return this.oldest[v]?(this.oldest=this.oldest[v],this.oldest[p]=void 0):(this.oldest=void 0,this.newest=void 0),e[v]=e[p]=void 0,this.map.delete(e.key),--this.size,[e.key,e.value]}},{key:"has",value:function(e){return this.map.has(e)}},{key:"assign",value:function(e){var t=void 0,n=this.limit||Number.MAX_VALUE;this.map.clear();for(var r=e[Symbol.iterator](),a=r.next();!a.done;a=r.next()){var i={key:a.value[0],value:a.value[1]};if(this.map.set(i.key,i),t?(t[v]=i,i[p]=t):this.oldest=i,t=i,0===n--)throw new Error("overflow")}this.newest=t,this.size=this.map.size}},{key:"clear",value:function(){this.oldest=this.newest=void 0,this.size=0,this.map.clear()}}]),e}(),g="notsecurity",b=new E(100);var w=function(e){var t=e.children,n=e.context,r=e.initialItems,a=void 0===r?null:r,i=e.externalResources,s=void 0===i?{}:i,c=d(e,["children","context","initialItems","externalResources"]),l=Object(u.useState)(void 0)[1];return Object(u.useEffect)(function(){return a&&b.assign(a)}),o.a.createElement(n.Provider,{value:{getResource:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(){var n=arguments,r=function(e,t){return h.a.h32(JSON.stringify(arguments),g).toString(16)}(e,n);if(t||!b.has(r)){var a=c[e]||s[e],i=new Promise(function(e,t){a.apply(null,n).then(function(){e.apply(null,arguments)})}),u={status:"pending",args:void 0};throw i.then(function(){var e={status:"resolved",args:arguments};b.set(r,e),l(void 0)}),b.set(r,u),l(void 0),i}var o=b.get(r);if("resolved"===o.status)return o.args[0]}},clearCache:function(){b.clear()}}},t)},j=n(2),y=n(4),O=n.n(y);function k(){}var x=Object(r.createContext)({url:null,go:k,params:{},setParams:k});function C(e){var t=e.children,n=function(){var e=Object(r.useState)(window.location.pathname),t=Object(j.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)(function(){O()(function(e,t){return a(t)})}),[n,function(e){a(e),O()(e)}]}(),i=Object(j.a)(n,2),s=i[0],c=i[1];return a.a.createElement(x.Provider,{value:{url:s,go:c}},t)}var P=Object(r.createContext)({users:[],requestUsers:k,hello:null}),S=Object(r.createContext)({products:[]});function N(e,t){return Object(c.a)({},e,{id:t+1,slug:e.name.toLowerCase().replace(" ","_")})}function z(){return fetch("https://swapi.co/api/people/").then(function(e){return e.json()}).then(function(e){return e.results}).then(function(e){return e.map(N)})}function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.id?fetch("https://swapi.co/api/people/"+e.id).then(function(e){return e.json()}).then(N):new Promise(function(e){return e([])})}function R(){return fetch("https://swapi.co/api/starships/").then(function(e){return e.json()}).then(function(e){return e.results}).then(function(e){return e.map(N)})}function U(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.id?fetch("https://swapi.co/api/starships/"+e.id).then(function(e){return e.json()}).then(N):new Promise(function(e){return e([])})}var _={loadImage:function(e){var t=new Image;return new Promise(function(n){t.onload=function(){return setTimeout(function(){return n(e)},3e3)},t.src=e})}};var L=n(11),T=n.n(L)()();function J(e){var t=e.path,n=e.children,a=Object(r.useContext)(x).url,i=T(t)(a);return!1!==i?(a.split("/").filter(function(e){return e}).map(function(e,t){return i[t]=e}),n(i)):null}var M=n(1);function q(e){var t=e.href,n=e.children,r=Object(M.a)(e,["href","children"]);return a.a.createElement("a",Object.assign({},r,{href:t||"!#"}),n)}function A(e){var t=e.component,n=Object(M.a)(e,["component"]),i=Object(r.useContext)(x).go,s=t||q;return a.a.createElement(s,Object.assign({},n,{onClick:function(e){e.preventDefault(),e.stopPropagation(),n.onClick&&n.onClick(e),n.href&&i(n.href)}}))}function B(){throw new Promise(function(e){setTimeout(e,5e3)})}function D(){var e=Object(r.useContext)(P).clearCache;return a.a.createElement("div",{className:"topbar"},a.a.createElement(A,{href:"/"},"Home"),a.a.createElement(A,{href:"/users"},"People"),a.a.createElement(A,{href:"/products"},"Products"),a.a.createElement(A,{onClick:function(){return e()}},"Clear cache"),a.a.createElement(A,{onClick:B},"Throw"))}function G(e){var t=e.items,n=void 0===t?[]:t,r=e.children,i=Object(M.a)(e,["items","children"]);return n?a.a.createElement("ul",i,n.map(r)):null}function H(e){var t=e.children;return a.a.createElement("li",null,t)}function V(e){var t=e.id,n=Object(r.useContext)(P).getResource,i=n("fetchUser")({id:t});if(!i)return null;return a.a.createElement("div",{className:"user-detail"},a.a.createElement("div",{className:"image"},a.a.createElement(r.Suspense,{fallback:a.a.createElement("div",null,"loading image...")},i.image&&a.a.createElement(function(e){e.src;var t=n("loadImage")("https://raw.githubusercontent.com/johnlindquist/swapi-json-server/master/public/"+i.image);return a.a.createElement("img",{src:t,alt:i.name})},{src:i.image}))),a.a.createElement("div",{className:"name"},"Name: ",i.name),a.a.createElement("div",{className:"name"},"Gender: ",i.gender),a.a.createElement("div",{className:"name"},"Birth Year: ",i.birth_year))}function X(e){var t=e.id,n=(0,Object(r.useContext)(P).getResource)("fetchUsers")({});return n?a.a.createElement(G,{items:n},function(e){return a.a.createElement(H,{key:e.id},String(e.id)!==String(t)&&a.a.createElement("h2",null,a.a.createElement(A,{href:"/users/"+e.id},e.name)),String(e.id)===String(t)&&a.a.createElement(r.Suspense,{fallback:a.a.createElement("div",null,"Loading user detail...")},a.a.createElement(V,{id:t})))}):null}function Y(e){var t=e.id;return a.a.createElement(r.Suspense,{fallback:a.a.createElement("div",null,"Loading user list...")},a.a.createElement(X,{id:t}))}function F(){var e=(0,Object(r.useContext)(S).getResource)("fetchProducts")({id:9,name:"Leonard"});return a.a.createElement(G,{items:e},function(e){return a.a.createElement(H,{key:e.id},e.name)})}n(40);var K=document.getElementById("root");s.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(function(e){var t=e.children;return a.a.createElement(w,{context:S,fetchProducts:R,fetchProduct:U},a.a.createElement(w,Object.assign({context:P,fetchUsers:z,fetchUser:I},_),a.a.createElement(C,null,t)))},null,a.a.createElement(function(){return a.a.createElement(r.Suspense,{fallback:a.a.createElement("div",null,"global loading...")},a.a.createElement(J,{path:"(.*)"},function(e){return a.a.createElement(D,null)}),a.a.createElement(J,{path:"/"},function(e){return a.a.createElement("div",null,"initial")}),a.a.createElement(J,{path:"/users/:id?"},function(e){return a.a.createElement(Y,e)}),a.a.createElement(J,{path:"/products(/.*)?"},function(e){return a.a.createElement(F,null)}))},null))),K)}},[[13,2,1]]]);
//# sourceMappingURL=main.f8630cdd.chunk.js.map